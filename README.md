# CMPM 121 D1 Project: Monke Clicker (TypeScript)

Author: Bryce Han

An incremental clicker miniâ€‘game written in **TypeScript** with a tiny dataâ€‘driven shop system, smooth idle income using `requestAnimationFrame`, accessible counters, tooltips, and a darkâ€‘mode toggle.

## âœ¨ Features

- **Clicker core**: manual clicks increment your total.
- **Idle income**: passive rate increases per upgrade; timeâ€‘based using `requestAnimationFrame`.
- **Dataâ€‘driven shop**: all upgrades are defined in a single `availableItems` array and rendered in a loopâ€”no hardâ€‘coded buttons.
- **Reusable class**: `ShopItem` encapsulates cost/leveling, affordability, and UI updates.
- **Fair cost growth**: exponential pricing via `costGrowth` (e.g., `1.15` = +15%/purchase).
- **Tooltips**: perâ€‘item descriptions on hover (native `title` or custom tooltip element).
- **Dark mode**: CSS variables with a `.dark` class; toggle button fixed to the bottomâ€‘right and persisted with `localStorage`.
- **Responsive styles**: flex/grid friendly; centered layout options; button focus/hover/active states.
- **A11y**: live regions for counters and focus styles for keyboard users.

---

## ðŸ§  How It Works

### Animation Loop

```ts
let rafId: number | null = null;
let lastTs: number | null = null;

function step(now: number) {
  if (lastTs == null) lastTs = now;
  const deltaSec = (now - lastTs) / 1000;
  lastTs = now;

  count += RATE_PER_SECOND * deltaSec;
  updateCounters();
  rafId = requestAnimationFrame(step);
}
```

- Converts frame delta to seconds and accrues passive income at `RATE_PER_SECOND`.
- `startIncreasing()` guards against doubleâ€‘scheduling.

### Dataâ€‘Driven Shop

```ts
type ItemEffect =
  | { kind: "rate"; perLevel: number }
  | { kind: "click"; perLevel: number };

interface ItemConfig {
  id: string;
  label: string;
  emoji: string;
  baseCost: number;
  costGrowth: number; // e.g., 1.15
  maxLevel?: number;
  effect: ItemEffect;
  // description?: string; // optional for tooltips
}

const availableItems: ItemConfig[] = [
  {
    id: "banana",
    label: "Banana",
    emoji: "ðŸŒ",
    baseCost: 10,
    costGrowth: 1.15,
    effect: { kind: "rate", perLevel: 0.10 },
  },
  {
    id: "farm",
    label: "Banana Farm",
    emoji: "ðŸŒ´",
    baseCost: 50,
    costGrowth: 1.15,
    effect: { kind: "rate", perLevel: 1.00 },
  },
  {
    id: "factory",
    label: "Banana Factory",
    emoji: "ðŸ­",
    baseCost: 200,
    costGrowth: 1.15,
    effect: { kind: "rate", perLevel: 5.00 },
  },
];
```

All rendering and behavior is generated by iterating over `availableItems` and instantiating `ShopItem` for each config.

### `ShopItem` Responsibilities

- Renders a card with a button, level, and current price.
- `canAfford()` checks if `count >= cost`.
- `buy()` updates: deduct cost â†’ apply effect â†’ increase level â†’ recompute cost â†’ update UI.
- `updateDisabled()` enables/disables the button based on affordability (and optional max level).

---

## âž• Adding or Editing Upgrades

1. Add a new entry to `availableItems`:

   ```ts
   {
     id: "lab",
     label: "Banana Lab",
     emoji: "ðŸ”¬",
     baseCost: 1500,
     costGrowth: 1.18,
     effect: { kind: "rate", perLevel: 12.5 },
     // description: "Genetic tweaks boost output by +12.5/s"
   }
   ```

2. (Optional) If you want **manual click** upgrades, add `kind: "click"` effects and track a `CLICK_POWER` variable you apply in the click handler.

3. Tooltips:
   - **Native**: put `card.title = conf.description` (works even when the button is disabled).
   - **Custom**: add a `.tooltip` element (see CSS section below).

---

## ðŸŽ¨ Styling & Layout

- **Theme via CSS variables** in `:root`, with **dark overrides** under `.dark`:

  ```css
  :root {
    --bg: #fff;
    --text: #111827; /* ... */
  }
  .dark {
    --bg: #0b1020;
    --text: #e5e7eb; /* ... */
  }
  ```

- **Darkâ€‘mode toggle**: fixed at bottomâ€‘right (`#themeToggle`), persisted in `localStorage`.
- **Buttons**: larger touch target (`min-width`, `min-height`), hover/focus/active transitions.
- **Shop layout**: by default stacked + centered using flex; adjust `gap` for spacing.
- **Centering**: `#shop { display:flex; flex-direction:column; align-items:center; gap:1rem; }`.
- **Grid option**: switch to CSS Grid with `grid-template-columns` for multiâ€‘column shops.

### Optional Custom Tooltip (CSS)

```css
.shop-item {
  position: relative;
  display: inline-block;
}
.shop-item .tooltip {
  position: absolute;
  bottom: 120%;
  left: 50%;
  transform: translateX(-50%);
  background: var(--card);
  color: var(--text);
  border: 0.5px solid var(--muted);
  border-radius: 0.5rem;
  padding: 0.4rem 0.6rem;
  font-size: 0.8rem;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease, transform 0.15s ease;
  z-index: 1000;
}
.shop-item:hover .tooltip {
  opacity: 1;
  transform: translateX(-50%) translateY(-2px);
}
#shop {
  overflow: visible;
}
```

### Credit

I got the idea for the emoji as a clicker from ThatGuylain's : I got the idea from: <https://github.com/ThatGuyIain/cmpm-121-incremental-game/blob/main/src/main.ts>

I got the idea for the upgrade header from mrpoopers:
<https://github.com/mrpoopers/D1rich/tree/main>
